ä¸‹é¢è¿™ä»½æ˜¯ **Dart ä¸­ `Never` çš„ã€ŒçŸ¥è¯†ç‚¹å¤§å…¨ + ä½¿ç”¨å¤§å…¨ã€**ã€‚
è¿™æ˜¯ä¸€ä¸ª**é«˜çº§ä½†éå¸¸æœ‰ä»·å€¼**çš„ç±»å‹ï¼šä½ ä¸€æ—¦ç†è§£ `Never`ï¼Œå°±ç­‰äºçœŸæ­£ç†è§£äº† **Dart çš„ç±»å‹ç³»ç»Ÿã€ç©ºå®‰å…¨ã€æ§åˆ¶æµåˆ†æ**ã€‚

æˆ‘ä¼šæŒ‰ **ç›´è§‰ç†è§£ â†’ è¯­è¨€å®šä¹‰ â†’ ä½¿ç”¨åœºæ™¯ â†’ ä»£ç ç¤ºä¾‹ â†’ ç¼–è¯‘å™¨è§†è§’ â†’ å¸¸è§å‘** ç»™ä½ è®²æ¸…æ¥šã€‚

---

# ä¸€ã€Never æ˜¯ä»€ä¹ˆï¼Ÿï¼ˆä¸€å¥è¯å…ˆç«‹ä½ï¼‰

> **`Never` è¡¨ç¤ºï¼šè¿™ä¸ªå€¼â€œæ°¸è¿œä¸å¯èƒ½å­˜åœ¨â€**

æ¢å¥è¯è¯´ï¼š

> **è¿”å› `Never` çš„å‡½æ•°ï¼Œæ°¸è¿œä¸ä¼šæ­£å¸¸è¿”å›**

---

## ç›´è§‰ç±»æ¯”

| æƒ…å†µ        | ä¼šä¸ä¼šè¿”å›ï¼Ÿ |
| --------- | ------ |
| æ­£å¸¸ return | ä¼š      |
| æŠ›å¼‚å¸¸       | ä¸ä¼š     |
| æ­»å¾ªç¯       | ä¸ä¼š     |
| `exit()`  | ä¸ä¼š     |

ğŸ‘‰ **è¿™äº›éƒ½æ˜¯ `Never` çš„ä¸–ç•Œ**

---

# äºŒã€Never åœ¨ Dart ç±»å‹ä½“ç³»ä¸­çš„ä½ç½®

```text
           Object
              â†‘
           dynamic
              â†‘
           T / T?
              â†‘
            Never
```

âš ï¸ æ³¨æ„è¿™ä¸ªå…³é”®ç‚¹ï¼š

> **`Never` æ˜¯æ‰€æœ‰ç±»å‹çš„å­ç±»å‹ï¼ˆbottom typeï¼‰**

è¿™æ„å‘³ç€ï¼š

* `Never` å¯ä»¥èµ‹å€¼ç»™ **ä»»ä½•ç±»å‹**
* ä½† **æ²¡æœ‰ä»»ä½•å€¼** çš„çœŸå®ç±»å‹æ˜¯ `Never`

---

# ä¸‰ã€Never çš„è¯­è¨€çº§å®šä¹‰ï¼ˆéå¸¸é‡è¦ï¼‰

## 1ï¸âƒ£ Never ç±»å‹çš„å˜é‡ä¸èƒ½è¢«èµ‹å€¼

```dart
Never x; // âŒ ç¼–è¯‘é”™è¯¯ï¼ˆæ— æ³•åˆå§‹åŒ–ï¼‰
```

ğŸ“Œ å› ä¸ºï¼š

> `Never` è¡¨ç¤ºâ€œæ²¡æœ‰ä»»ä½•å¯èƒ½çš„å€¼â€

---

## 2ï¸âƒ£ è¿”å› Never çš„å‡½æ•°

```dart
Never fail(String message) {
  throw Exception(message);
}
```

è¿™ä¸ªå‡½æ•°ï¼š

* æ°¸è¿œä¸ä¼šèµ°åˆ°å‡½æ•°æœ«å°¾
* ç¼–è¯‘å™¨çŸ¥é“ï¼š**è°ƒç”¨å®ƒä¹‹åï¼Œç¨‹åºä¸ä¼šç»§ç»­æ‰§è¡Œ**

---

# å››ã€Never æœ€æ ¸å¿ƒçš„ç”¨é€”ï¼šæ§åˆ¶æµåˆ†æ

## 1ï¸âƒ£ throw è¡¨è¾¾å¼çš„ç±»å‹æ˜¯ Never

```dart
String getName(String? name) {
  if (name == null) {
    throw Exception('name is null');
  }

  // Dart çŸ¥é“ï¼šèµ°åˆ°è¿™é‡Œ name ä¸€å®šä¸æ˜¯ null
  return name; // âœ…
}
```

ğŸ“Œ è¿™æ˜¯ Dart ç©ºå®‰å…¨èƒ½â€œå˜èªæ˜â€çš„æ ¹æœ¬åŸå› ä¹‹ä¸€ã€‚

---

## 2ï¸âƒ£ æ°¸ä¸è¿”å›çš„å‡½æ•° = é€»è¾‘ç»ˆç‚¹

```dart
Never crash() {
  throw StateError('Crash!');
}

void test(int x) {
  if (x < 0) {
    crash();
  }

  print(x); // Dart çŸ¥é“ï¼šx >= 0
}
```

---

# äº”ã€Never åœ¨ switch / if ç©·å°½æ€§æ£€æŸ¥ä¸­çš„ä½œç”¨ï¼ˆé«˜çº§ï¼‰

## 1ï¸âƒ£ æšä¸¾ + Neverï¼ˆéå¸¸é‡è¦ï¼‰

```dart
enum Status { success, failure }

String handle(Status status) {
  switch (status) {
    case Status.success:
      return 'ok';
    case Status.failure:
      return 'fail';
  }
}
```

âš ï¸ ä½ å¯èƒ½ä»¥ä¸ºæ²¡é—®é¢˜ï¼Œä½†**ä¸€æ—¦ enum æ–°å¢å€¼**ï¼Œè¿™é‡Œä¼šæŠ¥é”™ã€‚

---

### æ›´å®‰å…¨çš„å†™æ³•ï¼ˆä½¿ç”¨ Neverï¼‰

```dart
Never _unreachable(Object value) {
  throw StateError('Unreachable: $value');
}

String handle(Status status) {
  switch (status) {
    case Status.success:
      return 'ok';
    case Status.failure:
      return 'fail';
  }

  return _unreachable(status);
}
```

ğŸ“Œ è¿™æ˜¯ä¸€ç§ **â€œç©·å°½æ€§ä¿æŠ¤â€æ¨¡å¼**

---

# å…­ã€Never ä¸æ³›å‹ï¼ˆè¿›é˜¶ï¼‰

## 1ï¸âƒ£ `Future<Never>`

```dart
Future<Never> alwaysFail() async {
  throw Exception('fail');
}
```

å«ä¹‰ï¼š

* è¿™ä¸ª Future ä¸€å®šä¼šå¤±è´¥
* æ°¸è¿œä¸ä¼š `complete` æˆåŠŸå€¼

---

## 2ï¸âƒ£ `Stream<Never>`

```dart
Stream<Never> emptyStream() async* {
  // æ°¸è¿œä¸ yield
}
```

---

# ä¸ƒã€Never ä¸ null safety çš„å…³ç³»ï¼ˆéå¸¸å…³é”®ï¼‰

## 1ï¸âƒ£ `Never` â‰  `Null`

| ç±»å‹      | å«ä¹‰          |
| ------- | ----------- |
| `Null`  | å”¯ä¸€å€¼æ˜¯ `null` |
| `Never` | æ²¡æœ‰ä»»ä½•å€¼       |

```dart
Null n = null; // âœ…
Never x = null; // âŒ
```

---

## 2ï¸âƒ£ Never å¸®åŠ©â€œæ¶ˆç­ nullâ€

```dart
T requireNotNull<T>(T? value) {
  if (value == null) {
    throw Exception('null');
  }
  return value; // è¿™é‡Œ T å·²ç»è¢«æ”¶çª„
}
```

ğŸ“Œ throw çš„ç±»å‹æ˜¯ `Never`ï¼Œæ‰€ä»¥æ§åˆ¶æµè¢«åˆ‡æ–­ã€‚

---

# å…«ã€Never åœ¨ Flutter / Dart å®æˆ˜ä¸­çš„çœŸå®ç”¨é€”

## 1ï¸âƒ£ é”™è¯¯å¤„ç†å‡½æ•°

```dart
Never error(String msg) {
  throw FlutterError(msg);
}
```

---

## 2ï¸âƒ£ assert-like å·¥å…·å‡½æ•°

```dart
Never unreachable() {
  throw StateError('Unreachable');
}
```

---

## 3ï¸âƒ£ å¼ºåˆ¶ä¸­æ–­æµç¨‹

```dart
Never exitApp() {
  exit(0);
}
```

---

# ä¹ã€Never çš„å¸¸è§è¯¯åŒºï¼ˆä½ ä¸€å®šè¦é¿å¼€ï¼‰

1ï¸âƒ£ è¯•å›¾å£°æ˜ `Never` å˜é‡
2ï¸âƒ£ ä»¥ä¸º `Never` æ˜¯â€œç©ºç±»å‹â€
3ï¸âƒ£ æŠŠ `Never` å½“æˆ `null`
4ï¸âƒ£ ä¸»åŠ¨è¿”å› `Never` å€¼ï¼ˆä¸å¯èƒ½ï¼‰
5ï¸âƒ£ åœ¨ä¸šåŠ¡æ¨¡å‹ä¸­ä½¿ç”¨ `Never`
6ï¸âƒ£ ä¸ç†è§£ throw ä¸ºä½•èƒ½â€œæ¶ˆé™¤ nullâ€

---

# åã€ä»€ä¹ˆæ—¶å€™ä½ â€œç”¨åˆ°â€ Neverï¼ˆä½†ä½ æ²¡æ„è¯†åˆ°ï¼‰

ä½ **å‡ ä¹æ¯å¤©éƒ½åœ¨ç”¨ Never**ï¼š

* `throw`
* `rethrow`
* `assert(false)`
* `default` æ°¸ä¸å‘½ä¸­çš„åˆ†æ”¯
* éç©ºæ ¡éªŒå¤±è´¥

åªæ˜¯ Dart åœ¨èƒŒåå¸®ä½ ç”¨å¥½äº†ã€‚

---

# åä¸€ã€ä¸€å¥è¯çœŸæ­£è®°ä½ Never

> **`Never` ä¸æ˜¯â€œè¿”å›å€¼ç±»å‹â€ï¼Œè€Œæ˜¯â€œç¨‹åºé€»è¾‘çš„ç»ˆç‚¹â€**

---

## å¦‚æœä½ æ„¿æ„ç»§ç»­è¿›é˜¶ï¼Œæˆ‘å¯ä»¥ç›´æ¥å¸¦ä½ å¾€æ›´é«˜å±‚èµ°ï¼š

* âœ… `Never` å¦‚ä½•è®© Dart çš„ç©ºå®‰å…¨â€œé›¶æ„ŸçŸ¥â€
* âœ… `Never` + sealed class / enum çš„æœ€ä½³æ¨¡å¼
* âœ… ç”¨ `Never` å†™å‡ºâ€œç¼–è¯‘æœŸæ›´å®‰å…¨â€çš„ Flutter ä»£ç 
* âœ… ä¸€é“ `Never` çš„é«˜é˜¶é¢è¯•é¢˜ï¼ˆ99% çš„äººç­”ä¸ä¸Šï¼‰

ä½ é€‰ä¸€ä¸ªï¼Œæˆ‘ç»§ç»­å¾€ä¸Šç»™ä½ â€œæŠ¬å¤©èŠ±æ¿â€ã€‚
