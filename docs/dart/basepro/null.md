ä¸‹é¢è¿™ä»½æ˜¯ **Dart ä¸­ `null` çš„ã€ŒçŸ¥è¯†ç‚¹ + ä½¿ç”¨å¤§å…¨ã€**ï¼Œæˆ‘æŒ‰ **ä»åº•å±‚è§„åˆ™ â†’ å¸¸è§è¯­æ³• â†’ å®æˆ˜æ¨¡å¼ â†’ æ˜“é”™ç‚¹** çš„é¡ºåºç»™ä½ ç³»ç»Ÿæ¢³ç†ä¸€éã€‚
ä½ ç°åœ¨æ˜¯ç³»ç»Ÿå­¦ Dart/Flutterï¼Œè¿™ä¸€å—**å¿…é¡»åƒé€**ï¼Œå¦åˆ™åé¢å†™ UIã€å¼‚æ­¥ã€æ¨¡å‹è§£æéƒ½ä¼šåå¤è¸©å‘ã€‚

---

## ä¸€ã€Dart ä¸­ `null` çš„æœ¬è´¨ï¼ˆå…ˆç«‹è§„çŸ©ï¼‰

### 1ï¸âƒ£ Null Safetyï¼ˆç©ºå®‰å…¨ï¼‰æ˜¯ä»€ä¹ˆ

ä» **Dart 2.12** å¼€å§‹ï¼ŒDart **é»˜è®¤å¼€å¯ç©ºå®‰å…¨**ï¼š

> **å˜é‡é»˜è®¤ä¸å…è®¸ä¸º null**

```dart
int a = 10;
// a = null; âŒ ç¼–è¯‘é”™è¯¯
```

ğŸ‘‰ è¿™æ˜¯ Dart å’Œ JS æœ€å¤§çš„åŒºåˆ«ä¹‹ä¸€ã€‚

---

### 2ï¸âƒ£ å¯ç©ºç±»å‹ï¼ˆNullable Typeï¼‰

ä½¿ç”¨ `?` è¡¨ç¤º **å¯èƒ½ä¸º null**

```dart
int? a;
a = null;   // âœ…
a = 10;     // âœ…
```

| å†™æ³•   | å«ä¹‰        |
| ---- | --------- |
| `T`  | æ°¸è¿œä¸ä¸º null |
| `T?` | å¯èƒ½ä¸º null  |

---

## äºŒã€null ç›¸å…³çš„æ ¸å¿ƒè¯­æ³•ï¼ˆé‡ç‚¹ï¼‰

## 1ï¸âƒ£ ç©ºæ–­è¨€æ“ä½œç¬¦ `!`

> **æˆ‘ç¡®å®šå®ƒä¸æ˜¯ null**

```dart
int? a = 10;
int b = a!; // å‘Šè¯‰ç¼–è¯‘å™¨ï¼šä¿¡æˆ‘
```

âš ï¸ å¦‚æœä½ åˆ¤æ–­é”™äº†ï¼š

```dart
int? a;
print(a!); // âŒ è¿è¡Œæ—¶å´©æºƒ
```

ğŸ“Œ åŸåˆ™ï¼š

> **èƒ½ä¸ç”¨ `!` å°±ä¸ç”¨**

---

## 2ï¸âƒ£ ç©ºå®‰å…¨è®¿é—® `?.`

> **å¦‚æœä¸ä¸º null å°±è®¿é—®**

```dart
String? name;

print(name?.length); // null
```

ç­‰ä»·äºï¼š

```dart
if (name != null) {
  print(name.length);
}
```

ğŸ“Œ Flutter ä¸­æå…¶å¸¸è§

---

## 3ï¸âƒ£ ç©ºåˆå¹¶è¿ç®—ç¬¦ `??`

> **ä¸º null æ—¶ç»™é»˜è®¤å€¼**

```dart
String? name;

print(name ?? 'é»˜è®¤å€¼'); // é»˜è®¤å€¼
```

å¸¸è§ç”¨é€”ï¼š

* UI æ˜¾ç¤º
* JSON è§£æ
* å‚æ•°å…œåº•

---

## 4ï¸âƒ£ ç©ºåˆå¹¶èµ‹å€¼ `??=`

> **å¦‚æœæ˜¯ nullï¼Œæ‰èµ‹å€¼**

```dart
String? name;
name ??= 'å¼ ä¸‰';

print(name); // å¼ ä¸‰
```

---

## ä¸‰ã€å˜é‡å£°æ˜ä¸ null

### 1ï¸âƒ£ æ™®é€šå˜é‡

```dart
int a = 1;      // ä¸èƒ½ä¸º null
int? b = null; // å¯ä»¥
```

---

### 2ï¸âƒ£ late + null

#### late éç©ºå»¶è¿Ÿåˆå§‹åŒ–

```dart
late String name;

name = 'Tom';
print(name);
```

âš ï¸ å¦‚æœä½¿ç”¨å‰æ²¡èµ‹å€¼ï¼š

```dart
late String name;
print(name); // âŒ LateInitializationError
```

#### late + å¯ç©ºï¼ˆå¾ˆå°‘ç”¨ï¼‰

```dart
late String? name;
```

---

## å››ã€å‡½æ•°ä¸ null

### 1ï¸âƒ£ å¯ç©ºå‚æ•°

```dart
void printName(String? name) {
  print(name ?? 'åŒ¿å');
}
```

---

### 2ï¸âƒ£ å¯ç©ºè¿”å›å€¼

```dart
String? getName(bool ok) {
  if (ok) return 'Tom';
  return null;
}
```

---

### 3ï¸âƒ£ required + å¯ç©ºï¼ˆåˆæ³•ï¼‰

```dart
void foo({required String? name}) {
  print(name);
}
```

ğŸ“Œ å«ä¹‰ï¼š

* å¿…é¡»ä¼ 
* ä½†å…è®¸ä¼  null

---

## äº”ã€é›†åˆç±»å‹ä¸­çš„ nullï¼ˆéå¸¸é‡è¦ï¼‰

### 1ï¸âƒ£ List æ˜¯å¦èƒ½æ”¾ null

```dart
List<int> a = [1, 2, 3];
// a.add(null); âŒ

List<int?> b = [1, null, 3]; // âœ…
```

---

### 2ï¸âƒ£ List æœ¬èº«æ˜¯å¦å¯ä¸º null

```dart
List<int>? list;
```

ğŸ‘‰ **ä¸¤ä¸ªç»´åº¦**

| å†™æ³•            | å«ä¹‰                  |
| ------------- | ------------------- |
| `List<int>`   | åˆ—è¡¨ä¸ä¸º nullï¼Œå…ƒç´ ä¸ä¸º null |
| `List<int?>`  | åˆ—è¡¨ä¸ä¸º nullï¼Œå…ƒç´ å¯ä¸º null |
| `List<int>?`  | åˆ—è¡¨å¯ä¸º null           |
| `List<int?>?` | åˆ—è¡¨ã€å…ƒç´ éƒ½å¯ä¸º null       |

---

### 3ï¸âƒ£ Map çš„ null ç»„åˆ

```dart
Map<String, int?> map = {
  'a': 1,
  'b': null,
};
```

---

## å…­ã€null ä¸æ§åˆ¶æµåˆ†æï¼ˆDart å¾ˆèªæ˜ï¼‰

```dart
void test(String? s) {
  if (s == null) return;

  // Dart å·²æ¨æ–­ s ä¸ä¸º null
  print(s.length); // âœ…
}
```

ğŸ“Œ Dart çš„ **flow analysis** ä¼šè‡ªåŠ¨ç¼©å°ç±»å‹

---

## ä¸ƒã€ç©ºå®‰å…¨ä¸å¼‚æ­¥ï¼ˆFuture / asyncï¼‰

```dart
Future<String?> fetchName() async {
  return null;
}

void main() async {
  String? name = await fetchName();

  print(name ?? 'æœªè·å–åˆ°');
}
```

---

## å…«ã€JSON è§£æä¸­çš„ nullï¼ˆå®æˆ˜é«˜é¢‘ï¼‰

### âŒ é”™è¯¯å†™æ³•

```dart
name = json['name'];
```

### âœ… æ­£ç¡®å†™æ³•

```dart
name = json['name'] as String?;
```

æˆ–ï¼š

```dart
name = json['name'] ?? '';
```

---

## ä¹ã€Flutter ä¸­æœ€å¸¸è§çš„ null åœºæ™¯

### 1ï¸âƒ£ BuildContext

```dart
BuildContext? context;

// ä½¿ç”¨å‰åˆ¤æ–­
context?.findAncestorWidgetOfExactType();
```

---

### 2ï¸âƒ£ Widget å‚æ•°

```dart
class MyWidget extends StatelessWidget {
  final String? title;

  const MyWidget({this.title});
}
```

---

### 3ï¸âƒ£ Text æ˜¾ç¤ºå…œåº•

```dart
Text(title ?? 'é»˜è®¤æ ‡é¢˜')
```

---

## åã€æœ€å®¹æ˜“è¸©çš„ 10 ä¸ªå‘ï¼ˆåŠ¡å¿…çœ‹ï¼‰

1ï¸âƒ£ æ»¥ç”¨ `!`
2ï¸âƒ£ JSON å¼ºè½¬æ²¡åˆ¤ç©º
3ï¸âƒ£ List/Map æ³›å‹å†™é”™
4ï¸âƒ£ late æœªåˆå§‹åŒ–
5ï¸âƒ£ ä»¥ä¸º `required` å°±ä¸ä¸º null
6ï¸âƒ£ å‚æ•°æœªæ ‡ `?` å´ä¼  null
7ï¸âƒ£ `?.` å’Œ `!` æ··ç”¨
8ï¸âƒ£ è¿”å›å€¼å¿˜è®°æ ‡ `?`
9ï¸âƒ£ Stream/Future ç»“æœæ²¡åˆ¤ç©º
ğŸ”Ÿ Flutter setState ä¸­å¼•ç”¨ null

---

## åä¸€ã€ä»€ä¹ˆæ—¶å€™è¯¥æ€ä¹ˆé€‰ï¼Ÿï¼ˆç»éªŒæ³•åˆ™ï¼‰

| åœºæ™¯    | æ¨è      |
| ----- | ------- |
| ä¸€å®šå­˜åœ¨  | éç©ºç±»å‹    |
| å¤–éƒ¨æ•°æ®  | å¯ç©º      |
| UI å±•ç¤º | `??`    |
| ä¸´æ—¶å…œåº•  | `??=`   |
| ç¡®ä¿¡éç©º  | `!`ï¼ˆæ…ç”¨ï¼‰ |

---

## åäºŒã€ä¸€å¥è¯æ€»ç»“ï¼ˆç»™ä½ è®°ä½ï¼‰

> **Dart çš„ null ä¸æ˜¯â€œèƒ½ä¸èƒ½ç”¨â€ï¼Œè€Œæ˜¯â€œè®¾è®¡é˜¶æ®µå°±å¿…é¡»æƒ³æ¸…æ¥šâ€**

å¦‚æœä½ æ„¿æ„ï¼Œä¸‹ä¸€æ­¥æˆ‘å¯ä»¥ç›´æ¥ç»™ä½ ï¼š

* âœ… **Flutter ä¸­ null çš„æœ€ä½³å®è·µ**
* âœ… **null vs late çš„è®¾è®¡å¯¹æ¯”**
* âœ… **ä¸€é“â€œå…¨æ˜¯ null çš„ Dart é¢è¯•é¢˜è§£æâ€**
* âœ… **ä½ ç°æœ‰ä»£ç çš„ null å®‰å…¨é‡æ„ç¤ºä¾‹**

ä½ é€‰ä¸€ä¸ªï¼Œæˆ‘ç›´æ¥å¾€â€œå®æˆ˜å±‚â€å¸¦ä½ ã€‚
